<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cymbal Home Garden</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <aside id="left-sidebar-cart" class="cart-sidebar">
        <div class="cart-sidebar-header">
            <h3>Shopping Cart (<span id="cart-sidebar-item-count">0</span>)</h3>
            <button id="cart-sidebar-toggle-btn" aria-label="Toggle Cart Sidebar" class="cart-sidebar-toggle"><</button>
        </div>
        <div id="cart-sidebar-items-container" class="cart-items-container">
            <p>Your cart is empty.</p>
        </div>
        <div class="cart-sidebar-footer">
            <p>Subtotal: $<span id="cart-sidebar-subtotal">0.00</span></p>
            <button id="cart-sidebar-clear-btn">Clear Cart</button>
            </div>
    </aside>

    <header>
        <div class="header-logo-nav">
            <span class="header-logo-text">Cymbal</span>
            <nav class="header-main-nav">
                <a href="#">Orders</a>
                <a href="#">Plants</a>
                <a href="#">Flowers</a>
                <a href="#">Floristalies</a>
                <a href="#">Plants</a>
            </nav>
        </div>
        <div class="header-search-container">
            <i class="fas fa-search search-icon-prefix"></i>
            <input type="search" placeholder="Search products and more..." class="main-search-input">
        </div>
        <div class="header-title-actions">
            <div class="header-page-title-container">
                 <h2 class="header-page-title-text">Cymbal Home Garden</h2>
            </div>
            <p class="agent-demo-info">Demoing for Customer ID: <span id="current-customer-id">default_user</span></p>
            <button id="night-mode-toggle">Night Mode</button>
            <i class="fas fa-user header-action-icon"></i>
            <i class="fas fa-shopping-bag header-action-icon" id="header-cart-icon-placeholder"></i>
        </div>
    </header>

    <main>
        <section id="custom-hero-section">
            <div class="custom-hero-content-wrapper">
                <div class="custom-hero-text">
                    <h1 class="main-content-title">Cymbal Home Garden</h1>
                    <p class="subtitle">Refreshing greenery for your space, delivered to your door.</p>
                    <div class="custom-hero-actions">
                        <button class="btn-hero btn-primary-hero">Shop Now</button>
                        <button class="btn-hero btn-secondary-hero">Our Story</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="category-section">
            <h2 class="category-title">Shop our top <span class="category-highlight-text">Ott</span></h2>
            </section>

        <section id="product-listing" class="product-grid">
            </section>

        <section id="recommendations-section">
            <h2>You Might Also Like</h2>
            <div id="recommended-products-grid" class="product-grid recommended-grid">
                </div>
        </section>
    </main>

    <div id="checkout-review-modal" class="checkout-modal" style="display:none;">
        <div class="checkout-modal-content">
            <span class="checkout-modal-close-btn">&times;</span>
            <h2>Review Your Cart</h2>
            <div id="checkout-modal-items-container">
                <p>Loading cart...</p>
            </div>
            <div class="checkout-modal-summary">
                <p>Subtotal: $<span id="checkout-modal-subtotal">0.00</span></p>
            </div>
            <div class="checkout-modal-actions">
                <button id="checkout-modal-modify-btn">Modify Cart</button>
                <button id="checkout-modal-proceed-btn">Proceed (Next Step)</button>
            </div>
        </div>
    </div>

    <div id="checkout-shipping-modal" class="checkout-modal" style="display:none;">
        <div class="checkout-modal-content">
            <span class="checkout-modal-close-btn">&times;</span>
            <h2>Shipping Options</h2>
            <div class="shipping-options-container">
                <div class="shipping-option" id="shipping-home-delivery" data-value="home_delivery">
                    <input type="radio" name="shipping_option_radio" value="home_delivery" id="shipping-radio-home">
                    <label for="shipping-radio-home">Home Delivery</label>
                </div>
                <div class="shipping-option" id="shipping-pickup-point" data-value="pickup_point">
                    <input type="radio" name="shipping_option_radio" value="pickup_point" id="shipping-radio-pickup">
                    <label for="shipping-radio-pickup">Pickup Point</label>
                </div>
            </div>
            <div id="pickup-locations-list" style="display:none;" class="pickup-locations-container">
                <p>Loading pickup locations...</p>
            </div>
            <div class="checkout-modal-actions">
                <button id="shipping-back-btn">Back to Cart Review</button>
                <button id="shipping-continue-btn">Continue to Payment</button>
            </div>
        </div>
    </div>

    <div id="checkout-payment-modal" class="checkout-modal" style="display:none;">
        <div class="checkout-modal-content">
            <span class="checkout-modal-close-btn">&times;</span>
            <h2>Payment Options</h2>
            <div class="payment-options-container">
                <div class="payment-option">
                    <input type="radio" name="payment_method_radio" value="saved_card" id="payment-radio-saved" checked>
                    <label for="payment-radio-saved">Use Saved Card</label>
                    <div id="saved-card-details" class="card-details-form">
                        <p>Visa **** **** **** 1234</p>
                        <p>Expires: 12/2028</p>
                    </div>
                </div>
                <div class="payment-option">
                    <input type="radio" name="payment_method_radio" value="new_card" id="payment-radio-new">
                    <label for="payment-radio-new">Add a New Card</label>
                    <div id="new-card-form" style="display:none;" class="card-details-form">
                        <div class="form-group">
                            <label for="card-number">Card Number</label>
                            <input type="text" id="card-number" name="card-number" placeholder="Enter card number">
                        </div>
                        <div class="form-group">
                            <label for="card-expiry">Expiry Date (MM/YY)</label>
                            <input type="text" id="card-expiry" name="card-expiry" placeholder="MM/YY">
                        </div>
                        <div class="form-group">
                            <label for="card-cvc">CVC</label>
                            <input type="text" id="card-cvc" name="card-cvc" placeholder="CVC">
                        </div>
                        <div class="form-group">
                            <label for="card-name">Name on Card</label>
                            <input type="text" id="card-name" name="card-name" placeholder="Name on card">
                        </div>
                        <button id="save-card-btn" class="btn-secondary">Save Card</button>
                    </div>
                </div>
            </div>
            <div class="checkout-modal-actions">
                <button id="payment-back-btn">Back to Shipping</button>
                <button id="payment-confirm-btn">Confirm Payment</button>
            </div>
        </div>
    </div>
<div id="checkout-confirmation-modal" class="checkout-modal" style="display:none;">
        <div class="checkout-modal-content">
            <span class="checkout-modal-close-btn">&times;</span>
            <h2>Order Submitted!</h2>
            <div style="text-align: center; padding: 20px 0;">
                <i class="fas fa-check-circle" style="font-size: 48px; color: var(--current-accent-color-green); margin-bottom: 16px;"></i>
                <p style="font-size: 1.1rem; margin-bottom: 8px;">Thank you for your purchase!</p>
                <p style="color: var(--current-text-color-subtle);">Your order has been successfully submitted.</p>
            </div>
            <div class="checkout-modal-actions">
                <button id="confirmation-close-btn">Continue Shopping</button>
            </div>
        </div>
    </div>

    <div id="agent-launcher-icon" class="agent-launcher" style="position: fixed; bottom: 20px; right: 20px; background-color: #007bff; color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 9998;">
        <i class="fa-solid fa-comment-dots fa-2x"></i>
    </div>
    
    {% include 'agent_widget.html' %} 

    <div id="order-success-notification" class="order-success-popup">
        Order successfully submitted!
    </div>

    <footer>
        <p>&copy; 2025 Cymbal Home Garden</p>
    </footer>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
    
    <script type="module">
        document.addEventListener('DOMContentLoaded', () => {
            const launcherIcon = document.getElementById('agent-launcher-icon');
            const agentWidgetElement = document.querySelector('.agent-widget'); 

            if (launcherIcon && agentWidgetElement) {
                launcherIcon.addEventListener('click', () => {
                    agentWidgetElement.style.display = 'flex'; 
                    launcherIcon.style.display = 'none';   
                    agentWidgetElement.dispatchEvent(new CustomEvent('widgetOpened', { bubbles: true }));
                });

                agentWidgetElement.addEventListener('widgetClosed', () => {
                    agentWidgetElement.style.display = 'none'; 
                    launcherIcon.style.display = 'flex';  
                });
            } else {
                console.error("Launcher icon or agent widget element not found.");
            }
        });
    </script>
</body>
</html>
